(window.webpackJsonp=window.webpackJsonp||[]).push([[83],{700:function(_,v,t){"use strict";t.r(v);var d=t(8),e=Object(d.a)({},(function(){var _=this,v=_.$createElement,t=_._self._c||v;return t("ContentSlotsDistributor",{attrs:{"slot-key":_.$parent.slotKey}},[t("h2",{attrs:{id:"_1-引言"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-引言"}},[_._v("#")]),_._v(" 1. 引言")]),_._v(" "),t("p",[_._v("本规范旨在统一数据库设计标准，保障数据一致性、完整性、性能与可维护性，适用于所有业务系统的数据库设计（如 MySQL、PostgreSQL 等关系型数据库），需结合业务场景灵活落地。")]),_._v(" "),t("h2",{attrs:{id:"_2-命名规范"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-命名规范"}},[_._v("#")]),_._v(" 2. 命名规范")]),_._v(" "),t("h3",{attrs:{id:"_2-1-核心原则"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-核心原则"}},[_._v("#")]),_._v(" 2.1 核心原则")]),_._v(" "),t("ul",[t("li",[t("p",[_._v("统一采用 “小写字母 + 下划线” 命名法，禁止混合大小写、特殊字符（如"),t("code",[_._v("#")]),_._v("、"),t("code",[_._v("$")]),_._v("）或数据库关键字（如"),t("code",[_._v("select")]),_._v("、"),t("code",[_._v("order")]),_._v("）；")])]),_._v(" "),t("li",[t("p",[_._v("所有命名需体现业务含义，避免无意义缩写或数字标识（如"),t("code",[_._v("index1")]),_._v("、"),t("code",[_._v("t1")]),_._v("）；")])]),_._v(" "),t("li",[t("p",[_._v("表名、字段名、索引名长度控制在 30 字符内（避免超出数据库命名长度限制）。")])])]),_._v(" "),t("h3",{attrs:{id:"_2-2-各对象命名规范"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-各对象命名规范"}},[_._v("#")]),_._v(" 2.2 各对象命名规范")]),_._v(" "),t("table",[t("thead",[t("tr",[t("th",[_._v("对象类型")]),_._v(" "),t("th",[_._v("规范要求")]),_._v(" "),t("th",[_._v("正例")]),_._v(" "),t("th",[_._v("反例")]),_._v(" "),t("th",[_._v("反例问题")])])]),_._v(" "),t("tbody",[t("tr",[t("td",[_._v("表名")]),_._v(" "),t("td",[_._v("业务模块前缀 + 核心含义（如"),t("code",[_._v("user_")]),_._v("、"),t("code",[_._v("order_")]),_._v("）")]),_._v(" "),t("td",[t("code",[_._v("user_info")]),_._v("（用户信息表）、"),t("code",[_._v("order_detail")]),_._v("（订单明细表）")]),_._v(" "),t("td",[t("code",[_._v("UserInfo")]),_._v("（混合大小写）、"),t("code",[_._v("order")]),_._v("（无模块前缀 + 关键字）")]),_._v(" "),t("td",[_._v("协作理解成本高，需转义关键字")])]),_._v(" "),t("tr",[t("td",[_._v("字段名")]),_._v(" "),t("td",[_._v("核心含义 + 统一后缀（如时间用"),t("code",[_._v("_at")]),_._v("、状态用"),t("code",[_._v("_status")]),_._v("）")]),_._v(" "),t("td",[t("code",[_._v("user_id")]),_._v("（用户 ID）、"),t("code",[_._v("created_at")]),_._v("（创建时间）")]),_._v(" "),t("td",[t("code",[_._v("uid")]),_._v("（无意义缩写）、"),t("code",[_._v("CreatedTime")]),_._v("（驼峰命名）")]),_._v(" "),t("td",[_._v("新人需额外文档理解，命名不统一")])]),_._v(" "),t("tr",[t("td",[_._v("索引名")]),_._v(" "),t("td",[_._v("类型标识（"),t("code",[_._v("idx_")]),_._v("普通索引 /"),t("code",[_._v("uni_")]),_._v("唯一索引）+ 字段组合")]),_._v(" "),t("td",[t("code",[_._v("idx_user_id_status")]),_._v("（用户 ID + 状态普通索引）、"),t("code",[_._v("uni_user_phone")]),_._v("（用户手机号唯一索引）")]),_._v(" "),t("td",[t("code",[_._v("index2")]),_._v("（无含义）、"),t("code",[_._v("user_index")]),_._v("（无类型标识）")]),_._v(" "),t("td",[_._v("维护时无法快速判断索引用途")])]),_._v(" "),t("tr",[t("td",[_._v("视图名")]),_._v(" "),t("td",[_._v("前缀"),t("code",[_._v("view_")]),_._v("+ 业务含义")]),_._v(" "),t("td",[t("code",[_._v("view_user_order")]),_._v("（用户订单关联视图）")]),_._v(" "),t("td",[t("code",[_._v("user_order_view")]),_._v("（前缀不统一）")]),_._v(" "),t("td",[_._v("无法快速区分视图与表")])])])]),_._v(" "),t("h2",{attrs:{id:"_3-结构设计规范"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-结构设计规范"}},[_._v("#")]),_._v(" 3. 结构设计规范")]),_._v(" "),t("h3",{attrs:{id:"_3-1-范式与反范式平衡"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-范式与反范式平衡"}},[_._v("#")]),_._v(" 3.1 范式与反范式平衡")]),_._v(" "),t("ul",[t("li",[t("p",[t("strong",[_._v("优先遵循第三范式")]),_._v("：消除数据冗余与传递依赖（如用户手机号仅存于"),t("code",[_._v("user_info")]),_._v("，不冗余到"),t("code",[_._v("order_detail")]),_._v("）；")])]),_._v(" "),t("li",[t("p",[t("strong",[_._v("非核心场景适当反范式")]),_._v("：高频查询表（如商品详情页）可冗余关联字段（如"),t("code",[_._v("product")]),_._v("表冗余"),t("code",[_._v("category_name")]),_._v("），减少 JOIN 操作，需通过定时任务 / 消息队列同步数据。")])])]),_._v(" "),t("h3",{attrs:{id:"_3-2-表拆分与扩展"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-表拆分与扩展"}},[_._v("#")]),_._v(" 3.2 表拆分与扩展")]),_._v(" "),t("table",[t("thead",[t("tr",[t("th",[_._v("规范要求")]),_._v(" "),t("th",[_._v("正例")]),_._v(" "),t("th",[_._v("反例")]),_._v(" "),t("th",[_._v("反例问题")])])]),_._v(" "),t("tbody",[t("tr",[t("td",[_._v("大表拆分")]),_._v(" "),t("td",[_._v("订单表按时间分表："),t("code",[_._v("order_202501")]),_._v("、"),t("code",[_._v("order_202502")]),_._v("（单表数据≤1000 万）")]),_._v(" "),t("td",[_._v("单表存储 5 亿订单数据")]),_._v(" "),t("td",[_._v("查询耗时从 100ms 增至 5s，索引失效")])]),_._v(" "),t("tr",[t("td",[_._v("字段扩展")]),_._v(" "),t("td",[_._v("预留扩展字段需注明用途："),t("code",[_._v("ext1 VARCHAR(64) COMMENT '预留：用户等级标识'")])]),_._v(" "),t("td",[_._v("无注释的"),t("code",[_._v("ext1")]),_._v("、"),t("code",[_._v("ext2")])]),_._v(" "),t("td",[_._v("后续维护无法判断字段用途，易滥用")])]),_._v(" "),t("tr",[t("td",[_._v("附属表拆分")]),_._v(" "),t("td",[_._v("大字段（如用户头像、文章内容）拆分至附属表："),t("code",[_._v("user_avatar")]),_._v("（存头像路径）")]),_._v(" "),t("td",[_._v("主表"),t("code",[_._v("user_info")]),_._v("含"),t("code",[_._v("avatar BLOB")]),_._v("字段")]),_._v(" "),t("td",[_._v("主表查询时加载大字段，性能下降")])])])]),_._v(" "),t("h2",{attrs:{id:"_4-字段设计规范"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-字段设计规范"}},[_._v("#")]),_._v(" 4. 字段设计规范")]),_._v(" "),t("h3",{attrs:{id:"_4-1-通用字段设计原则"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-通用字段设计原则"}},[_._v("#")]),_._v(" 4.1 通用字段设计原则")]),_._v(" "),t("ul",[t("li",[t("p",[_._v("优先选择 “最小且合适” 的数据类型（如状态用"),t("code",[_._v("TINYINT")]),_._v("，不用"),t("code",[_._v("INT")]),_._v("）；")])]),_._v(" "),t("li",[t("p",[_._v("非必要字段不设"),t("code",[_._v("NOT NULL")]),_._v("，关键字段（如"),t("code",[_._v("user_id")]),_._v("）设默认值或非空约束；")])]),_._v(" "),t("li",[t("p",[_._v("禁止用字符串存储日期、金额、状态等结构化数据。")])])]),_._v(" "),t("h3",{attrs:{id:"_4-2-常用字段专项规范"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-常用字段专项规范"}},[_._v("#")]),_._v(" 4.2 常用字段专项规范")]),_._v(" "),t("h4",{attrs:{id:"_4-2-1-时间类常用字段"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-1-时间类常用字段"}},[_._v("#")]),_._v(" 4.2.1 时间类常用字段")]),_._v(" "),t("table",[t("thead",[t("tr",[t("th",[_._v("字段名")]),_._v(" "),t("th",[_._v("数据类型")]),_._v(" "),t("th",[_._v("适用场景")]),_._v(" "),t("th",[_._v("正例")]),_._v(" "),t("th",[_._v("反例")]),_._v(" "),t("th",[_._v("设计原则")])])]),_._v(" "),t("tbody",[t("tr",[t("td",[t("code",[_._v("created_at")])]),_._v(" "),t("td",[t("code",[_._v("datetime")]),_._v("（时区同步用"),t("code",[_._v("timestamp")]),_._v("）")]),_._v(" "),t("td",[_._v("数据创建时间（用户注册、订单生成）")]),_._v(" "),t("td",[t("code",[_._v("created_at datetime NOT NULL DEFAULT CURRENT_TIMESTAMP")])]),_._v(" "),t("td",[t("code",[_._v("create_time VARCHAR(20)")]),_._v("（存"),t("code",[_._v("2025-11-06")]),_._v("）")]),_._v(" "),t("td",[_._v("统一用"),t("code",[_._v("_at")]),_._v("后缀，禁止字符串存储，设默认值")])]),_._v(" "),t("tr",[t("td",[t("code",[_._v("updated_at")])]),_._v(" "),t("td",[t("code",[_._v("datetime")])]),_._v(" "),t("td",[_._v("数据最后更新时间（订单状态修改）")]),_._v(" "),t("td",[t("code",[_._v("updated_at datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP")])]),_._v(" "),t("td",[t("code",[_._v("update_time")]),_._v("（无自动更新）")]),_._v(" "),t("td",[_._v("设 “更新时自动填充”，避免手动维护")])]),_._v(" "),t("tr",[t("td",[t("code",[_._v("deleted_at")])]),_._v(" "),t("td",[t("code",[_._v("datetime")])]),_._v(" "),t("td",[_._v("软删除标记（替代物理删除）")]),_._v(" "),t("td",[t("code",[_._v("deleted_at datetime DEFAULT NULL")]),_._v("（未删除为"),t("code",[_._v("NULL")]),_._v("）")]),_._v(" "),t("td",[t("code",[_._v("is_delete TINYINT(1)")]),_._v("（仅存是否删除）")]),_._v(" "),t("td",[_._v("保留删除时间便于追溯，不用布尔型单独存储")])]),_._v(" "),t("tr",[t("td",[t("code",[_._v("expired_at")])]),_._v(" "),t("td",[t("code",[_._v("datetime")])]),_._v(" "),t("td",[_._v("过期时间（优惠券、会员有效期）")]),_._v(" "),t("td",[t("code",[_._v("expired_at datetime NOT NULL")])]),_._v(" "),t("td",[t("code",[_._v("expire_date DATE")]),_._v("（仅存日期，无时间）")]),_._v(" "),t("td",[_._v("需精确控制过期时间时用"),t("code",[_._v("datetime")])])])])]),_._v(" "),t("h4",{attrs:{id:"_4-2-2-状态类常用字段"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-2-状态类常用字段"}},[_._v("#")]),_._v(" 4.2.2 状态类常用字段")]),_._v(" "),t("table",[t("thead",[t("tr",[t("th",[_._v("字段名")]),_._v(" "),t("th",[_._v("数据类型")]),_._v(" "),t("th",[_._v("适用场景")]),_._v(" "),t("th",[_._v("正例")]),_._v(" "),t("th",[_._v("反例")]),_._v(" "),t("th",[_._v("设计原则")])])]),_._v(" "),t("tbody",[t("tr",[t("td",[t("code",[_._v("status")])]),_._v(" "),t("td",[t("code",[_._v("TINYINT UNSIGNED")])]),_._v(" "),t("td",[_._v("通用状态（订单：0 = 未支付，1 = 已支付）")]),_._v(" "),t("td",[t("code",[_._v("status TINYINT UNSIGNED NOT NULL DEFAULT 0 COMMENT '0=未支付，1=已支付，2=已取消'")])]),_._v(" "),t("td",[t("code",[_._v("status VARCHAR(10)")]),_._v("（存 “未支付”）")]),_._v(" "),t("td",[_._v("用数字枚举 + 注释，禁止字符串存储")])]),_._v(" "),t("tr",[t("td",[t("code",[_._v("audit_status")])]),_._v(" "),t("td",[t("code",[_._v("TINYINT UNSIGNED")])]),_._v(" "),t("td",[_._v("审核状态（文章：0 = 待审核，1 = 通过）")]),_._v(" "),t("td",[t("code",[_._v("audit_status TINYINT UNSIGNED NOT NULL DEFAULT 0")])]),_._v(" "),t("td",[t("code",[_._v("check_status")]),_._v("（命名不统一）")]),_._v(" "),t("td",[_._v("业务场景 +"),t("code",[_._v("_status")]),_._v("，避免自定义模糊命名")])]),_._v(" "),t("tr",[t("td",[t("code",[_._v("is_valid")])]),_._v(" "),t("td",[t("code",[_._v("TINYINT(1)")])]),_._v(" "),t("td",[_._v("数据有效性（0 = 无效，1 = 有效）")]),_._v(" "),t("td",[t("code",[_._v("is_valid TINYINT(1) NOT NULL DEFAULT 1")])]),_._v(" "),t("td",[t("code",[_._v("is_active")]),_._v("/"),t("code",[_._v("is_enable")]),_._v("（混用）")]),_._v(" "),t("td",[_._v("布尔型状态统一用"),t("code",[_._v("is_+形容词")])])])])]),_._v(" "),t("h4",{attrs:{id:"_4-2-3-关联类常用字段"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-3-关联类常用字段"}},[_._v("#")]),_._v(" 4.2.3 关联类常用字段")]),_._v(" "),t("table",[t("thead",[t("tr",[t("th",[_._v("字段名")]),_._v(" "),t("th",[_._v("数据类型")]),_._v(" "),t("th",[_._v("适用场景")]),_._v(" "),t("th",[_._v("正例")]),_._v(" "),t("th",[_._v("反例")]),_._v(" "),t("th",[_._v("设计原则")])])]),_._v(" "),t("tbody",[t("tr",[t("td",[t("code",[_._v("user_id")])]),_._v(" "),t("td",[_._v("与"),t("code",[_._v("user_info.id")]),_._v("一致（如"),t("code",[_._v("BIGINT")]),_._v("）")]),_._v(" "),t("td",[_._v("关联用户表")]),_._v(" "),t("td",[t("code",[_._v("user_id BIGINT NOT NULL COMMENT '关联user_info.id'")])]),_._v(" "),t("td",[t("code",[_._v("uid INT")]),_._v("（缩写 + 类型不匹配）")]),_._v(" "),t("td",[_._v("关联表名 +"),t("code",[_._v("_id")]),_._v("，类型与被关联主键一致")])]),_._v(" "),t("tr",[t("td",[t("code",[_._v("parent_id")])]),_._v(" "),t("td",[_._v("与当前表"),t("code",[_._v("id")]),_._v("一致")]),_._v(" "),t("td",[_._v("自关联（分类上下级、评论回复）")]),_._v(" "),t("td",[t("code",[_._v("parent_id BIGINT DEFAULT 0 COMMENT '父分类ID，0=顶级'")])]),_._v(" "),t("td",[t("code",[_._v("pid")]),_._v("（缩写）")]),_._v(" "),t("td",[_._v("自关联固定用"),t("code",[_._v("parent_id")])])])])]),_._v(" "),t("h4",{attrs:{id:"_4-2-4-标识-描述类常用字段"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-4-标识-描述类常用字段"}},[_._v("#")]),_._v(" 4.2.4 标识 / 描述类常用字段")]),_._v(" "),t("table",[t("thead",[t("tr",[t("th",[_._v("字段名")]),_._v(" "),t("th",[_._v("数据类型")]),_._v(" "),t("th",[_._v("适用场景")]),_._v(" "),t("th",[_._v("正例")]),_._v(" "),t("th",[_._v("反例")]),_._v(" "),t("th",[_._v("设计原则")])])]),_._v(" "),t("tbody",[t("tr",[t("td",[t("code",[_._v("id")])]),_._v(" "),t("td",[t("code",[_._v("BIGINT UNSIGNED")])]),_._v(" "),t("td",[_._v("表主键（自增）")]),_._v(" "),t("td",[t("code",[_._v("id BIGINT UNSIGNED NOT NULL AUTO_INCREMENT PRIMARY KEY")])]),_._v(" "),t("td",[t("code",[_._v("user_id")]),_._v("（主键名不统一）")]),_._v(" "),t("td",[_._v("单表主键固定用"),t("code",[_._v("id")]),_._v("，自增 + 无符号")])]),_._v(" "),t("tr",[t("td",[t("code",[_._v("uuid")])]),_._v(" "),t("td",[t("code",[_._v("CHAR(36)")])]),_._v(" "),t("td",[_._v("全局唯一标识（分布式系统）")]),_._v(" "),t("td",[t("code",[_._v("uuid CHAR(36) NOT NULL COMMENT '全局唯一UUID'")])]),_._v(" "),t("td",[t("code",[_._v("uuid VARCHAR(50)")]),_._v("（长度冗余）")]),_._v(" "),t("td",[_._v("用"),t("code",[_._v("CHAR(36)")]),_._v("（UUID 标准长度）")])]),_._v(" "),t("tr",[t("td",[t("code",[_._v("remark")])]),_._v(" "),t("td",[t("code",[_._v("VARCHAR(512)")])]),_._v(" "),t("td",[_._v("备注（订单备注、操作说明）")]),_._v(" "),t("td",[t("code",[_._v("remark VARCHAR(512) DEFAULT '' COMMENT '用户订单备注'")])]),_._v(" "),t("td",[t("code",[_._v("remark TEXT")]),_._v("（大字段滥用）")]),_._v(" "),t("td",[_._v("内容≤1000 字用"),t("code",[_._v("VARCHAR")]),_._v("，避免"),t("code",[_._v("TEXT")])])])])]),_._v(" "),t("h2",{attrs:{id:"_5-索引设计规范"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-索引设计规范"}},[_._v("#")]),_._v(" 5. 索引设计规范")]),_._v(" "),t("h3",{attrs:{id:"_5-1-核心原则"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-1-核心原则"}},[_._v("#")]),_._v(" 5.1 核心原则")]),_._v(" "),t("ul",[t("li",[t("p",[_._v("主键必设（优先自增"),t("code",[_._v("BIGINT")]),_._v("，避免"),t("code",[_._v("UUID")]),_._v("导致索引碎片化）；")])]),_._v(" "),t("li",[t("p",[_._v("单表索引数量≤5 个（过多索引导致写入性能下降 30%+）；")])]),_._v(" "),t("li",[t("p",[_._v("联合索引遵循 “最左前缀原则”，高频查询字段放左侧。")])])]),_._v(" "),t("h3",{attrs:{id:"_5-2-索引设计"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-2-索引设计"}},[_._v("#")]),_._v(" 5.2 索引设计")]),_._v(" "),t("table",[t("thead",[t("tr",[t("th",[_._v("场景")]),_._v(" "),t("th",[_._v("正例")]),_._v(" "),t("th",[_._v("反例")]),_._v(" "),t("th",[_._v("反例问题")])])]),_._v(" "),t("tbody",[t("tr",[t("td",[_._v("高频查询")]),_._v(" "),t("td",[_._v("登录验证："),t("code",[_._v("uni_user_phone")]),_._v("（手机号唯一索引）")]),_._v(" "),t("td",[_._v("为"),t("code",[_._v("user_info")]),_._v("的"),t("code",[_._v("gender")]),_._v("（性别，区分度低）建索引")]),_._v(" "),t("td",[_._v("扫描行数占比高，索引无效")])]),_._v(" "),t("tr",[t("td",[_._v("联合索引")]),_._v(" "),t("td",[_._v("订单查询："),t("code",[_._v("idx_user_id_created_at")]),_._v("（用户 ID + 创建时间）")]),_._v(" "),t("td",[t("code",[_._v("idx_create_at_user_id")]),_._v("（高频字段在后）")]),_._v(" "),t("td",[_._v("无法命中 “用户 ID + 时间范围” 查询")])]),_._v(" "),t("tr",[t("td",[_._v("避免失效")]),_._v(" "),t("td",[_._v("时间范围查询："),t("code",[_._v("created_at BETWEEN '2025-11-01' AND '2025-11-06'")])]),_._v(" "),t("td",[t("code",[_._v("DATE_FORMAT(create_at, '%Y-%m') = '2025-11'")])]),_._v(" "),t("td",[_._v("函数操作导致索引失效，全表扫描")])])])]),_._v(" "),t("h2",{attrs:{id:"_6-完整性约束规范"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_6-完整性约束规范"}},[_._v("#")]),_._v(" 6. 完整性约束规范")]),_._v(" "),t("table",[t("thead",[t("tr",[t("th",[_._v("约束类型")]),_._v(" "),t("th",[_._v("规范要求")]),_._v(" "),t("th",[_._v("正例")]),_._v(" "),t("th",[_._v("反例")]),_._v(" "),t("th",[_._v("反例问题")])])]),_._v(" "),t("tbody",[t("tr",[t("td",[_._v("主键约束")]),_._v(" "),t("td",[_._v("单表唯一主键，自增"),t("code",[_._v("BIGINT")])]),_._v(" "),t("td",[t("code",[_._v("id BIGINT UNSIGNED AUTO_INCREMENT PRIMARY KEY")])]),_._v(" "),t("td",[_._v("无主键或用"),t("code",[_._v("UUID")]),_._v("做主键")]),_._v(" "),t("td",[_._v("无主键导致数据无法唯一定位，"),t("code",[_._v("UUID")]),_._v("影响性能")])]),_._v(" "),t("tr",[t("td",[_._v("外键约束")]),_._v(" "),t("td",[_._v("核心表（如"),t("code",[_._v("order")]),_._v("关联"),t("code",[_._v("user")]),_._v("）用外键，高频更新表（如社交好友表）应用层校验")]),_._v(" "),t("td",[t("code",[_._v("user_id BIGINT NOT NULL REFERENCES user_info(id)")])]),_._v(" "),t("td",[_._v("所有表均无外键，应用层未校验")]),_._v(" "),t("td",[_._v("数据不一致（如删除用户后残留订单）")])]),_._v(" "),t("tr",[t("td",[_._v("唯一约束")]),_._v(" "),t("td",[_._v("需去重字段（手机号、商品编码）加唯一索引")]),_._v(" "),t("td",[t("code",[_._v("uni_user_phone")]),_._v("（手机号唯一索引）")]),_._v(" "),t("td",[_._v("业务层判断去重，无数据库约束")]),_._v(" "),t("td",[_._v("高并发下导致重复数据")])]),_._v(" "),t("tr",[t("td",[_._v("CHECK 约束")]),_._v(" "),t("td",[_._v("字段合法性校验（如年龄 1-120 岁）")]),_._v(" "),t("td",[t("code",[_._v("age TINYINT UNSIGNED CHECK (age BETWEEN 1 AND 120)")])]),_._v(" "),t("td",[_._v("仅应用层校验年龄")]),_._v(" "),t("td",[_._v("绕过应用层操作时插入非法数据")])])])]),_._v(" "),t("h2",{attrs:{id:"_7-性能与安全规范"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_7-性能与安全规范"}},[_._v("#")]),_._v(" 7. 性能与安全规范")]),_._v(" "),t("table",[t("thead",[t("tr",[t("th",[_._v("规范维度")]),_._v(" "),t("th",[_._v("要求")]),_._v(" "),t("th",[_._v("正例")]),_._v(" "),t("th",[_._v("反例")]),_._v(" "),t("th",[_._v("反例问题")])])]),_._v(" "),t("tbody",[t("tr",[t("td",[_._v("存储引擎")]),_._v(" "),t("td",[_._v("优先"),t("code",[_._v("InnoDB")]),_._v("（支持事务、行锁），日志表可"),t("code",[_._v("MyISAM")])]),_._v(" "),t("td",[t("code",[_._v("user_info")]),_._v("用"),t("code",[_._v("InnoDB")]),_._v("，"),t("code",[_._v("sys_log")]),_._v("用"),t("code",[_._v("MyISAM")])]),_._v(" "),t("td",[_._v("混合引擎（"),t("code",[_._v("user")]),_._v("用"),t("code",[_._v("InnoDB")]),_._v("，"),t("code",[_._v("order")]),_._v("用"),t("code",[_._v("MyISAM")]),_._v("）")]),_._v(" "),t("td",[_._v("跨表事务不支持，数据一致性风险")])]),_._v(" "),t("tr",[t("td",[_._v("敏感数据")]),_._v(" "),t("td",[_._v("加密存储（密码哈希，手机号脱敏）")]),_._v(" "),t("td",[_._v("密码："),t("code",[_._v("SHA-256")]),_._v("加盐哈希；手机号：`SUBSTR (phone,1,3)")]),_._v(" "),t("td"),_._v(" "),t("td")]),_._v(" "),t("tr",[t("td",[_._v("分库分表")]),_._v(" "),t("td",[_._v("数据量超 1000 万规划拆分（按时间、地域、用户 ID 哈希）")]),_._v(" "),t("td",[_._v("订单表按用户 ID 哈希分 3 库 10 表")]),_._v(" "),t("td",[_._v("单库单表存储 5 亿数据")]),_._v(" "),t("td",[_._v("连接超时，查询无法响应")])])])]),_._v(" "),t("h2",{attrs:{id:"_8-规范落地建议"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_8-规范落地建议"}},[_._v("#")]),_._v(" 8. 规范落地建议")]),_._v(" "),t("ol",[t("li",[t("p",[t("strong",[_._v("设计前校验")]),_._v("：使用 “数据库设计校验清单”（含命名、字段类型、索引数量等），避免遗漏；")])]),_._v(" "),t("li",[t("p",[t("strong",[_._v("定期评审")]),_._v("：每季度检查线上表结构，删除冗余索引、清理无用字段；")])]),_._v(" "),t("li",[t("p",[t("strong",[_._v("工具辅助")]),_._v("：用 SQL lint 工具（如"),t("code",[_._v("sqlfluff")]),_._v("）自动检测命名与类型规范，集成到 CI/CD 流程；")])]),_._v(" "),t("li",[t("p",[t("strong",[_._v("文档同步")]),_._v("：表结构变更需更新文档，记录字段含义、约束规则及变更原因。")])])])])}),[],!1,null,null,null);v.default=e.exports}}]);