(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{559:function(t,s,a){t.exports=a.p+"assets/img/58.f818234e.png"},560:function(t,s,a){t.exports=a.p+"assets/img/push.cd6be9a3.png"},561:function(t,s,a){t.exports=a.p+"assets/img/zz.53caec93.png"},562:function(t,s,a){t.exports=a.p+"assets/img/machine-type.995eb196.png"},563:function(t,s,a){t.exports=a.p+"assets/img/raid0.2a8771a9.png"},564:function(t,s,a){t.exports=a.p+"assets/img/raid1.4f4b5cb8.png"},565:function(t,s,a){t.exports=a.p+"assets/img/rad10.0f8413ca.png"},566:function(t,s,a){t.exports=a.p+"assets/img/raid01.0eb8f136.png"},567:function(t,s,a){t.exports=a.p+"assets/img/raid5.6330f2f6.png"},568:function(t,s,a){t.exports=a.p+"assets/img/web.6b25bc06.png"},569:function(t,s,a){t.exports=a.p+"assets/img/im.cc7c874a.png"},570:function(t,s,a){t.exports=a.p+"assets/img/zz_fc.c250d613.png"},571:function(t,s,a){t.exports=a.p+"assets/img/feed.b867bc16.png"},572:function(t,s,a){t.exports=a.p+"assets/img/jieruceng.ce8f72fa.png"},573:function(t,s,a){t.exports=a.p+"assets/img/io.3a3e11bd.png"},574:function(t,s,a){t.exports=a.p+"assets/img/cap.b09c2b64.png"},575:function(t,s,a){t.exports=a.p+"assets/img/2pc.76437ffe.png"},576:function(t,s,a){t.exports=a.p+"assets/img/2pc1.2c6f7713.png"},577:function(t,s,a){t.exports=a.p+"assets/img/paxos.f293ab73.png"},578:function(t,s,a){t.exports=a.p+"assets/img/2pc_paxos.f69445e6.png"},579:function(t,s,a){t.exports=a.p+"assets/img/cold_backup.6ca07e56.png"},580:function(t,s,a){t.exports=a.p+"assets/img/hot-backup.2f5fbb4e.png"},581:function(t,s,a){t.exports=a.p+"assets/img/hot.7aee7df8.png"},582:function(t,s,a){t.exports=a.p+"assets/img/backup1.127595ee.png"},583:function(t,s,a){t.exports=a.p+"assets/img/backup3.52542a6c.png"},584:function(t,s,a){t.exports=a.p+"assets/img/recover.b499a971.png"},585:function(t,s,a){t.exports=a.p+"assets/img/move.104422ba.png"},586:function(t,s,a){t.exports=a.p+"assets/img/table.a4208ee4.png"},587:function(t,s,a){t.exports=a.p+"assets/img/table1.ac0bebb7.png"},588:function(t,s,a){t.exports=a.p+"assets/img/cache.35dac76d.png"},589:function(t,s,a){t.exports=a.p+"assets/img/cache2.e8f98c66.png"},590:function(t,s,a){t.exports=a.p+"assets/img/cache3.76e31437.png"},591:function(t,s,a){t.exports=a.p+"assets/img/memcached.27006140.png"},592:function(t,s,a){t.exports=a.p+"assets/img/redis.9a227fef.png"},593:function(t,s,a){t.exports=a.p+"assets/img/cache4.4660cc27.png"},594:function(t,s,a){t.exports=a.p+"assets/img/ha.18cd24c1.png"},595:function(t,s,a){t.exports=a.p+"assets/img/consistent.bbbbe3b8.png"},596:function(t,s,a){t.exports=a.p+"assets/img/c.324e54c0.png"},597:function(t,s,a){t.exports=a.p+"assets/img/tool.99bc4bc8.png"},598:function(t,s,a){t.exports=a.p+"assets/img/monito.9f28319a.png"},599:function(t,s,a){t.exports=a.p+"assets/img/thread.0ee2bf71.png"},600:function(t,s,a){t.exports=a.p+"assets/img/stack.4e3e7d6a.png"},601:function(t,s,a){t.exports=a.p+"assets/img/cpu.a7d2f3c3.png"},602:function(t,s,a){t.exports=a.p+"assets/img/top.5ec6b6ca.png"},603:function(t,s,a){t.exports=a.p+"assets/img/source.601bef55.png"},604:function(t,s,a){t.exports=a.p+"assets/img/lock.992a8d8f.png"},605:function(t,s,a){t.exports=a.p+"assets/img/pratice.f4f405a2.png"},606:function(t,s,a){t.exports=a.p+"assets/img/enhance.9d99eaad.png"},607:function(t,s,a){t.exports=a.p+"assets/img/enhance2.c01cf2fd.png"},608:function(t,s,a){t.exports=a.p+"assets/img/push1.829fd382.png"},663:function(t,s,a){"use strict";a.r(s);var i=a(8),_=Object(i.a)({},(function(){var t=this,s=t.$createElement,i=t._self._c||s;return i("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[i("h2",{attrs:{id:"传统的all-in-one存在的问题"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#传统的all-in-one存在的问题"}},[t._v("#")]),t._v(" 传统的ALL IN ONE存在的问题")]),t._v(" "),i("ul",[i("li",[t._v("耦合严重")]),t._v(" "),i("li",[t._v("职责不分明")]),t._v(" "),i("li",[t._v("运维成本高")]),t._v(" "),i("li",[t._v("模块大、臃肿")]),t._v(" "),i("li",[t._v("性能极限差")]),t._v(" "),i("li",[t._v("牵一发动全身")]),t._v(" "),i("li",[t._v("开发成本高、效率低下")]),t._v(" "),i("li",[t._v("组件间相互影响，一旦一个组件有问题整个服务都受影响")]),t._v(" "),i("li",[t._v("扩展性差")])]),t._v(" "),i("h2",{attrs:{id:"分层原则"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#分层原则"}},[t._v("#")]),t._v(" 分层原则")]),t._v(" "),i("ul",[i("li",[t._v("数据库服务和逻辑服务分离")]),t._v(" "),i("li",[t._v("逻辑服务和接入服务分层")]),t._v(" "),i("li",[t._v("接入服务和展示服务分离")])]),t._v(" "),i("p",[t._v("设计原则")]),t._v(" "),i("ol",[i("li",[t._v("分层服务功能单一\n数据\n逻辑\n接入\n展示")]),t._v(" "),i("li",[t._v("分层低耦合\n接口交付")]),t._v(" "),i("li",[t._v("分层高内聚\n功能聚焦单一")])]),t._v(" "),i("h2",{attrs:{id:"如何分层"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#如何分层"}},[t._v("#")]),t._v(" 如何分层")]),t._v(" "),i("ol",[i("li",[i("p",[t._v("前端框架\nMVC框架分层")])]),t._v(" "),i("li",[i("p",[t._v("后端架构\n按照功能水平划分\n四层：\n接入层、逻辑层、数据层、数据存储\n接入层、逻辑层、原子服务层、数据存储\n五层：\n接入层、序列号层（异步消息队列）、逻辑层、数据层、数据存储")]),t._v(" "),i("p",[t._v("按照业务垂直拆分\n房产、招聘、二手\nIM、交友等")])])]),t._v(" "),i("h2",{attrs:{id:"常遇到问题"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#常遇到问题"}},[t._v("#")]),t._v(" 常遇到问题")]),t._v(" "),i("ul",[i("li",[t._v("数据不兼容、误删除\n数据备份")])]),t._v(" "),i("h2",{attrs:{id:"案例"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#案例"}},[t._v("#")]),t._v(" 案例")]),t._v(" "),i("p",[i("img",{attrs:{src:a(559),alt:"image-20201212110047337"}})]),t._v(" "),i("p",[i("img",{attrs:{src:a(560),alt:"push"}})]),t._v(" "),i("p",[i("img",{attrs:{src:a(561),alt:"image-2020121211051935"}})]),t._v(" "),i("h2",{attrs:{id:"硬件层面设计"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#硬件层面设计"}},[t._v("#")]),t._v(" 硬件层面设计")]),t._v(" "),i("p",[t._v("SOA和微服务：SOA比较粗")]),t._v(" "),i("h4",{attrs:{id:"互联网主流构成"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#互联网主流构成"}},[t._v("#")]),t._v(" 互联网主流构成")]),t._v(" "),i("ul",[i("li",[i("p",[t._v("CPU\n32 Processor ，每核2个处理器，开启超线程\n2.5GHZ")])]),t._v(" "),i("li",[i("p",[t._v("内存\n32、64、128")])]),t._v(" "),i("li",[i("p",[t._v("磁盘\nSATA机械盘、SAS机械盘、SSD固态硬盘")])]),t._v(" "),i("li",[i("p",[t._v("网卡")]),t._v(" "),i("p",[t._v("100、1000mbs")])])]),t._v(" "),i("p",[t._v("机型分类")]),t._v(" "),i("ul",[i("li",[t._v("内存性\n128G内存")]),t._v(" "),i("li",[t._v("I/O型")]),t._v(" "),i("li",[t._v("存储型")]),t._v(" "),i("li",[t._v("计算型\nGPU")])]),t._v(" "),i("p",[t._v("服务器型号")]),t._v(" "),i("p",[i("img",{attrs:{src:a(562),alt:"image-20201212172750428"}})]),t._v(" "),i("h4",{attrs:{id:"应用场景"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#应用场景"}},[t._v("#")]),t._v(" 应用场景")]),t._v(" "),i("p",[t._v("Web业务场景")]),t._v(" "),i("ul",[i("li",[t._v("内存型、计算型")])]),t._v(" "),i("p",[t._v("逻辑业务场景")]),t._v(" "),i("ul",[i("li",[t._v("计算型")])]),t._v(" "),i("p",[t._v("Cache应用")]),t._v(" "),i("ul",[i("li",[t._v("内存型")])]),t._v(" "),i("p",[t._v("测试应用")]),t._v(" "),i("ul",[i("li",[t._v("虚拟机")])]),t._v(" "),i("h2",{attrs:{id:"raid"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#raid"}},[t._v("#")]),t._v(" RAID")]),t._v(" "),i("ul",[i("li",[i("p",[t._v("RAID 0")]),t._v(" "),i("p",[t._v("数据分条，加速读写\n"),i("img",{attrs:{src:a(563),alt:"image-20201212174136134"}})])]),t._v(" "),i("li",[i("p",[t._v("RAID 1\n冗余\n"),i("img",{attrs:{src:a(564),alt:"image-20201212174241906"}})])]),t._v(" "),i("li",[i("p",[t._v("RAID10")]),t._v(" "),i("p",[t._v("RAID 0 + RAID 1\n"),i("img",{attrs:{src:a(565),alt:"image-20201212174511087"}})])]),t._v(" "),i("li",[i("p",[t._v("RAID01")]),t._v(" "),i("p",[t._v("RAID1 + RAID0\n"),i("img",{attrs:{src:a(566),alt:"image-2020121217461658"}})])]),t._v(" "),i("li",[i("p",[t._v("RAID5\n分布式奇偶校验，独立磁盘")]),t._v(" "),i("p",[i("img",{attrs:{src:a(567),alt:"image-20201212175332459"}})])])]),t._v(" "),i("h4",{attrs:{id:"硬件层面高可用"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#硬件层面高可用"}},[t._v("#")]),t._v(" 硬件层面高可用")]),t._v(" "),i("ul",[i("li",[i("p",[t._v("RAID优化")]),t._v(" "),i("p",[t._v("较大的磁条大小提供较好的读取性能，特别是系统主要进行顺序读取更是如此。DB机器stripe size 都设置成128K，其他机器选择的是64K")])]),t._v(" "),i("li",[i("p",[t._v("读写策略")]),t._v(" "),i("p",[t._v("foce wb with no battery （不使用电池强制回写）")])]),t._v(" "),i("li",[i("p",[t._v("多机\n系统多机冗余")]),t._v(" "),i("p",[t._v("数据多机冗余")]),t._v(" "),i("p",[t._v("保证高可用")])])]),t._v(" "),i("h2",{attrs:{id:"dns"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#dns"}},[t._v("#")]),t._v(" DNS")]),t._v(" "),i("p",[t._v("DNS域名劫持校验")]),t._v(" "),i("ol",[i("li",[t._v("nslookup 查看address")]),t._v(" "),i("li",[t._v("whois [address] 查看是不是正确域名提供商")])]),t._v(" "),i("p",[t._v("DNS欺骗")]),t._v(" "),i("p",[t._v("和劫持类似")]),t._v(" "),i("h2",{attrs:{id:"dns解决方案"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#dns解决方案"}},[t._v("#")]),t._v(" DNS解决方案")]),t._v(" "),i("p",[t._v("数据合法性校验")]),t._v(" "),i("ul",[i("li",[t._v("数据是否完整")]),t._v(" "),i("li",[t._v("数据时效")])]),t._v(" "),i("p",[t._v("实时监控 + 商务推动")]),t._v(" "),i("ul",[i("li",[t._v("语义监控")])]),t._v(" "),i("p",[t._v("绕过自动分配DNS")]),t._v(" "),i("ul",[i("li",[i("p",[t._v("使用IP地址")])]),t._v(" "),i("li",[i("p",[t._v("使用httpDNS")]),t._v(" "),i("p",[i("strong",[t._v("解决问题")]),t._v("\nLocalDNS被劫持\n平均访问延迟下降\n用户连接失败率下降（智能连接算法）\n"),i("strong",[t._v("使用场景")])]),t._v(" "),i("p",[t._v("需要引入SDK\n移动客户端")])])]),t._v(" "),i("p",[t._v("浏览器劫持")]),t._v(" "),i("ul",[i("li",[i("p",[t._v("DNS劫持")])]),t._v(" "),i("li",[i("p",[t._v("CDN劫持")])]),t._v(" "),i("li",[i("p",[t._v("网关劫持")])]),t._v(" "),i("li",[i("p",[t._v("网关劫持")]),t._v(" "),i("p",[t._v("HTTPS、SSL、加密")])])]),t._v(" "),i("p",[t._v("最佳实践")]),t._v(" "),i("ul",[i("li",[t._v("尽可能选用HttpDNS")]),t._v(" "),i("li",[t._v("基于IP直连")]),t._v(" "),i("li",[t._v("传统DNS监控、及时报警、商务推动")])]),t._v(" "),i("p",[i("strong",[t._v("流量被劫持")])]),t._v(" "),i("ul",[i("li",[i("p",[t._v("代理劫持")])]),t._v(" "),i("li",[i("p",[t._v("链路劫持")])])]),t._v(" "),i("h2",{attrs:{id:"cdn"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#cdn"}},[t._v("#")]),t._v(" CDN")]),t._v(" "),i("p",[t._v("全局负载均衡器")]),t._v(" "),i("p",[t._v("局部负载均衡")]),t._v(" "),i("p",[i("img",{attrs:{src:a(568),alt:"image-20201212211310306"}})]),t._v(" "),i("p",[i("img",{attrs:{src:a(569),alt:"image-20201212211430406"}})]),t._v(" "),i("p",[i("img",{attrs:{src:a(570),alt:"image-20201212214241919"}})]),t._v(" "),i("p",[i("img",{attrs:{src:a(571),alt:"image-20201212214354899"}})]),t._v(" "),i("h3",{attrs:{id:"接入层作用"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#接入层作用"}},[t._v("#")]),t._v(" 接入层作用")]),t._v(" "),i("ul",[i("li",[t._v("客户端长短连接管理")]),t._v(" "),i("li",[t._v("建立与客户端通信的加密通道")]),t._v(" "),i("li",[t._v("合法性、正确性校验")]),t._v(" "),i("li",[t._v("整合内部少量的连接")]),t._v(" "),i("li",[t._v("session管理")]),t._v(" "),i("li",[t._v("初步实施攻防")]),t._v(" "),i("li",[t._v("请求转发到逻辑层")])]),t._v(" "),i("p",[i("img",{attrs:{src:a(572),alt:"image-20201212221109576"}})]),t._v(" "),i("p",[t._v("逻辑层设计")]),t._v(" "),i("p",[t._v("垂直拆分：根据每个业务一个模块，独立进程")]),t._v(" "),i("p",[i("strong",[t._v("无状态")])]),t._v(" "),i("p",[t._v("业务逻辑层不保存任何请求状态、数据，完全对称，负载均衡")]),t._v(" "),i("p",[t._v("异步调用场景")]),t._v(" "),i("p",[t._v("I/O，网络I/O")]),t._v(" "),i("p",[i("img",{attrs:{src:a(573),alt:"image-20201213103746705"}})]),t._v(" "),i("p",[t._v("设置合理的超时时间、重试")]),t._v(" "),i("p",[i("strong",[t._v("服务降级")])]),t._v(" "),i("ul",[i("li",[t._v("通过队列方式，拒绝低优先服务的")]),t._v(" "),i("li",[t._v("随机丢弃")]),t._v(" "),i("li",[t._v("关闭服务")])]),t._v(" "),i("p",[i("strong",[t._v("服务幂等设计")])]),t._v(" "),i("p",[t._v("天然幂等 - 消息设置成已读")]),t._v(" "),i("p",[t._v("非幂等 - 增加状态达到幂等")]),t._v(" "),i("p",[i("strong",[t._v("数据存储")])]),t._v(" "),i("p",[t._v("多机存储")]),t._v(" "),i("p",[t._v("复制")]),t._v(" "),i("p",[t._v("故障检测")]),t._v(" "),i("p",[i("img",{attrs:{src:a(574),alt:"image-20201213181743684"}})]),t._v(" "),i("p",[i("img",{attrs:{src:a(575),alt:"image-20201213181930640"}})]),t._v(" "),i("p",[i("img",{attrs:{src:a(576),alt:"image-20201213182022710"}})]),t._v(" "),i("p",[i("img",{attrs:{src:a(577),alt:"image-20201213182150671"}})]),t._v(" "),i("p",[i("img",{attrs:{src:a(578),alt:"image-20201213182248063"}})]),t._v(" "),i("p",[i("img",{attrs:{src:a(579),alt:"image-2020121318253142"}})]),t._v(" "),i("p",[i("img",{attrs:{src:a(580),alt:"image-2020121318264570"}})]),t._v(" "),i("p",[i("img",{attrs:{src:a(581),alt:"image-20201213182737071"}})]),t._v(" "),i("p",[i("img",{attrs:{src:a(582),alt:"image-20201213182853441"}})]),t._v(" "),i("p",[i("img",{attrs:{src:a(583),alt:"image-2020121318293625"}})]),t._v(" "),i("p",[i("img",{attrs:{src:a(584),alt:"image-20201213183020154"}})]),t._v(" "),i("p",[i("img",{attrs:{src:a(585),alt:"image-20201213183342964"}})]),t._v(" "),i("p",[i("img",{attrs:{src:a(586),alt:"image-20201213183519087"}})]),t._v(" "),i("p",[i("img",{attrs:{src:a(587),alt:"image-20201213183548452"}})]),t._v(" "),i("h2",{attrs:{id:"缓存"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#缓存"}},[t._v("#")]),t._v(" 缓存")]),t._v(" "),i("p",[t._v("加速请求，响应延迟小")]),t._v(" "),i("p",[t._v("减少存储的读写 压力")]),t._v(" "),i("p",[i("img",{attrs:{src:a(588),alt:"image-20201213184554476"}})]),t._v(" "),i("p",[i("img",{attrs:{src:a(589),alt:"image-2020121318464845"}})]),t._v(" "),i("p",[i("img",{attrs:{src:a(590),alt:"image-20201213184931737"}})]),t._v(" "),i("p",[i("img",{attrs:{src:a(591),alt:"image-20201213185143236"}})]),t._v(" "),i("p",[i("img",{attrs:{src:a(592),alt:"image-20201213185333393"}})]),t._v(" "),i("p",[i("img",{attrs:{src:a(593),alt:"image-20201213190032550"}})]),t._v(" "),i("p",[i("img",{attrs:{src:a(594),alt:"image-2020121319013813"}})]),t._v(" "),i("p",[i("img",{attrs:{src:a(595),alt:"image-2020121319042461"}})]),t._v(" "),i("h2",{attrs:{id:"性能评估"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#性能评估"}},[t._v("#")]),t._v(" 性能评估")]),t._v(" "),i("p",[i("img",{attrs:{src:a(596),alt:"image-20201213191643799"}})]),t._v(" "),i("p",[i("img",{attrs:{src:a(597),alt:"image-20201213192009650"}})]),t._v(" "),i("p",[i("img",{attrs:{src:a(598),alt:"image-20201214233937625"}})]),t._v(" "),i("p",[i("img",{attrs:{src:a(599),alt:"image-20201217221132439"}})]),t._v(" "),i("p",[i("img",{attrs:{src:a(600),alt:"image-20201217221210711"}})]),t._v(" "),i("p",[i("img",{attrs:{src:a(601),alt:"image-20201217221434833"}})]),t._v(" "),i("p",[i("img",{attrs:{src:a(602),alt:"image-20201217221458703"}})]),t._v(" "),i("p",[i("img",{attrs:{src:a(603),alt:"image-20201217221645975"}})]),t._v(" "),i("p",[i("img",{attrs:{src:a(604),alt:"image-20201217221759935"}})]),t._v(" "),i("p",[i("img",{attrs:{src:a(605),alt:"image-20201217222046596"}})]),t._v(" "),i("p",[i("img",{attrs:{src:a(606),alt:"image-20201217223820293"}})]),t._v(" "),i("p",[i("img",{attrs:{src:a(607),alt:"image-20201217223947676"}})]),t._v(" "),i("p",[i("img",{attrs:{src:a(608),alt:"image-20201217224351812"}})])])}),[],!1,null,null,null);s.default=_.exports}}]);